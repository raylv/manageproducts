/*
 * Copyright (C) 2009-2016 SAP SE or an SAP affiliate company. All rights reserved.
 */
sap.ui.define(["sap/m/MessageBox","sap/ui/model/json/JSONModel","./utilities"],function(M,J,u){"use strict";function E(d){if(jQuery.sap.startsWith(d||"","{\"error\":")){var e=new J();e.setJSON(d);return e.getProperty("/error/message/value")||"Error";}}function p(P){var o=null,r=null,e={};o=P.getParameters?P.getParameters():null;r=o?(o.response||o):P;e.sDetails=r.responseText||r.body||(r.response&&r.response.body)||"";e.sMessage=E(e.sDetails)||r.message||(o&&o.message);return e;}function s(t,m,a){M.show(m,{icon:M.Icon.ERROR,title:t,details:a,actions:M.Action.CLOSE,styleClass:u.getContentDensityClass()});}return{showErrorMessage:function(P,v){var e=p(P),b=v.getModel("i18n").getResourceBundle(),t=b.getText("xtit.error");s(t,e.sMessage,e);},showXMLErrorMessage:function(P,v){try{var x=jQuery.parseXML(P);var a=jQuery(x);}catch(e){jQuery.sap.log.error(e);}if(a){var m=a.find("errordetails").find("message").text();var b=a.find("error").find("message").text();}else{m=P;}var B=v.getModel("i18n").getResourceBundle(),t=B.getText("xtit.error");s(t,m,b);},getErrorContent:function(P){return p(P).sMessage;},getErrorDetails:function(P){return p(P).sDetails;},extractErrorMessageFromDetails:function(d){return E(d);}};});
